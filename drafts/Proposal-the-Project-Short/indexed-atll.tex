Modeling attack trees without costs is only half of the picture.  So
how do we add costs?  Furthermore, can the quantitative layer impact
the logical layer (process tree) and vice versa?  I answer both of
these questions in this section.

The answer to the first question lies in a generalization of
Bucciarelli and Ehrhardâ€™s indexed linear logic
\cite{BUCCIARELLI:2000}. Hence, I extend ATLL into Indexed ATLL which
has the ability to model and reason about attack trees with costs.
The formalization of Indexed ATLL I present in this paper is a
simplification of the fully general system.  This simplified version
will make the main ideas easier to see by the reader without those
ideas being drowned out by technicalities.  Throughout this section I
will explain how Indexed ATLL can be generalized to the full system.

Attack trees are generalized to include costs by the following
definition.
\begin{definition}
  \label{def:atrees}
  Suppose $\mathsf{B}$ is a set of base attacks whose elements are
  denoted by $[[b]]$, and $\mathsf{C}$ is a set of costs whose
  elements are denoted by $[[c]]$.  Additionally, let
  $(\mathsf{C},[[(.)op]])$ and $(\mathsf{C},[[+op]])$ be symmetric
  monoids on $\mathsf{C}$, and $(\mathsf{C},[[>op]])$ be a monoid on
  $\mathsf{C}$, where $[[(.)op]]$ and $[[>op]]$ distribute over
  $[[+op]]$.  Then an \textbf{attack tree with costs} is defined by
  the following grammar:
  \[
  \begin{array}{lll}
    [[T]] ::= [[(b,c)]] \mid [[T1 (.) T2]] \mid [[T1 + T2]] \mid [[T1 > T2]]\\
  \end{array}
  \]  
\end{definition}
\begin{figure}\footnotesize
  \begin{mdframed}
    \begin{mathpar}
      \IATLLdruleTXXvar{} \and
      \IATLLdruleTXXpara{} \and
      \IATLLdruleTXXseq{} \and
      \IATLLdruleTXXchoice{}
    \end{mathpar}
  \end{mdframed}
  \caption{Well Formed Attack Trees in Indexed ATLL}
  \label{fig:wf-index-attack-trees}
\end{figure}
Each base attack is annotated with a cost, and every branching node is
associated with a binary operation for computing the cost at that node
using the costs of the left subtree and the right subtree.  The
requirement that each binary operation is monoidal insures that each
of the attack tree equations (Table~\ref{table:attack-tree-eqs}) lift
to the quantitative layer. As one can see from the definition of
attack trees there is a single operation that will compute the cost
across each type of branching operator, for example, computing the
cost of each sequential branching node will use the exact same
operation.  This is generalized in the full system by indexing each of
the branching operators with a monoidal operation of the same type
given here.  This will allow each branching node to use a different
operator if desired.

I now extend the syntax and rules of ATLL into Indexed ATLL, but due
to space I do not give every rule here, but only the most interesting
ones, because they are similar to ATLL; the entire system is defined
in Appendix~\ref{subsec:the_full_specification_of_indexed_atll}.
\begin{restatable}[]{definition}{iatllSyntax}
  \label{def:ATLL-syntax}
  Suppose $\mathsf{B}$ is a set of base attacks whose elements are
  denoted by $[[b]]$, and $\mathsf{C}$ is a set of costs whose
  elements are denoted by $[[c]]$.  Additionally, let
  $(\mathsf{C},[[(.)op]])$ and $(\mathsf{C},[[+op]])$ be symmetric
  monoids on $\mathsf{C}$, and $(\mathsf{C},[[>op]])$ be a monoid on
  $\mathsf{C}$, where $[[(.)op]]$ and $[[>op]]$ distribute over
  $[[+op]]$.  Furthermore, let $(\mathsf{C}, [[-oop]])$ be a preorder
  on $\mathsf{C}$ where $[[-oop]]([[+op]]([[c]],[[c]]),[[c]])$ and $[[-oop]]([[c]],[[+op]]([[c]],[[c]]))$.  Then
  the syntax of Indexed ATLL formulas and contexts are defined as
  follows:
  \[
  \begin{array}{cll}
    \text{(formulas)}         & [[E]] ::= [[(b, c)]] \mid [[E1 (.) E1]] \mid [[E1 + E2]] \mid [[E1 > E2]] \mid [[E1 c -o E2]]\\
    \text{(base contexts)}    & [[G]],[[D]] ::= [[.]] \mid [[(b,c)]] \mid [[G,D]]\\
    \text{(general contexts)} & [[I]],[[H]],[[P]] ::= [[.]] \mid [[(E,c)]] \mid [[G,D]]\\\\
  \end{array}
  \]
\end{restatable}
\vspace{-10px} As we can see the only major changes to the ATLL syntax
is that all hypotheses are annotated with costs, and there is a new
preorder, $[[-oop]]$, on costs such that
$[[-oop]]([[+op]]([[c]],[[c]]),[[c]])$ and
$[[-oop]]([[c]],[[+op]]([[c]],[[c]]))$ both hold.  This insures that
the contraction equation $[[h(T + T) o-o T]]$ holds in Indexed ATLL.
This implies that the type of monoids one can instantiate
$(\mathsf{C},[[+op]])$ to must satisfy the previous relationships, but
this includes the maximum and minimum monoids which are the most used
operations for choice. The hypothesis in implications, now denoted by
$[[E1 c -o E2]]$, are also annotated with a cost.  This is where we
begin to link the quantitative layer with the logical layer.  In the
introduction rule for linear implication the preorder on costs will be
used to influence when an implication will be provable.

The inference rules for well-formed attack trees in Indexed ATLL are
given in Figure~\ref{fig:wf-index-attack-trees}.  The sequent is now
denoted by $[[D |-T c T]]$ where $[[c]]$ is the fully computed cost
of the root of the attack tree $[[T]]$.  Notice that this cost is
computed during the construction of a proof derivation.  
\begin{figure}\small
  \begin{mdframed}
    \begin{mathpar}
      \IATLLdruleEXXvar{} \and
      \IATLLdruleEXXvarCC{} \and
      \IATLLdruleEXXvarC{} \and
      \IATLLdruleEXXseqI{} \and
      \IATLLdruleEXXseqE{} \and      
      \IATLLdruleEXXimpI{} \and
      \IATLLdruleEXXimpE{} 
    \end{mathpar}
  \end{mdframed}
  \caption{Select Logical Inference Rules for Indexed ATLL}
  \label{fig:atl}
\end{figure}

The main sequent for Indexed ATLL is denoted by $[[I;H;P |-c E]]$.
The cost, $[[c]]$, is the cost of the root of the syntax tree of
$[[E]]$, and if $[[E]]$ is an attack tree, then it is the cost of the
root of $[[E]]$.  This cost is computed during the construction of the
derivation proving $[[E]]$ holds in Indexed ATLL.  Thus, if $[[E]]$ is
an attack tree, then this will certify it is constructed correctly and
the costs are all computed using the given operations.  Furthermore,
proving implications between attack trees will be able to take this
cost into consideration.

The logical inference rules for Indexed ATLL are given in
Figure~\ref{fig:atl}.  As I mentioned above I only give a select few
of the rules here, but the complete system can be found in
Appendix~\ref{subsec:the_full_specification_of_indexed_atll}.  The
most interesting rule is the introduction rule for implication,
$[[-o]]_I$, because the second premise is $[[-oop]]([[c1]],[[c2]])$.

Suppose $[[(T1,c1)]]$ and $[[(T2,c2)]]$ are two attack trees with their
respective costs, and the relation $[[-oop]]([[c1]],[[c2]])$ holds if
and only if $[[c1]] \leq [[c2]]$. If we wanted to show that the attack
tree $[[T1]]$ is equivalent to the attack tree $[[T2]]$, then we would
have to show $[[T1 o-o T2]]$ where $[[o-oop]]([[c1]],[[c2]])$
holds if and only if $[[-oop]]([[c1]],[[c2]])$ and
$[[-oop]]([[c2]],[[c1]])$ hold.  This would require one to prove
$[[o-oop]]([[c1]],[[c2]])$ which would require $[[c1]] = [[c2]]$.
Thus, in this example, attack trees would be equivalent if and only if
they have the same logical structure and the same overall cost.  Thus,
several different types of reasoning on attack trees can be modeled in
Index ATLL depending on the relation chosen for implication.

The attack tree axioms, see
Appendix~\ref{subsec:the_full_specification_of_indexed_atll}, do not
differ from ATLL, but this is because of the additional structure
imposed on the cost operations.  For example, the following is one of
the distributive laws:
\[
\IATLLdruleEXXdistSeqOne{}
\]
Suppose $[[(T1,c1)]]$, $[[(T2,c2)]]$, and $[[(T3,c3)]]$ are all attack
trees.  Then the attack tree $[[T1 > (T2 + T3)]]$ has cost
$[[>op(c1,+op(c2,c3))]]$ and the attack $[[(T1 > T2) + (T1 > T3)]]$ has
cost $[[+op(>op(c1,c2),>op(c1,c3))]]$, and hence, it must be the case
that the following hold:
\[
\begin{array}{lll}
  [[-oop(>op(c1,+op(c2,c3)),+op(>op(c1,c2),>op(c1,c3)))]]\\
  [[-oop(+op(>op(c1,c2),>op(c1,c3)),>op(c1,+op(c2,c3)))]]
\end{array}  
\]
However, in the definition of Indexed ATLL
\[ [[>op(c1,+op(c2,c3))]] = [[+op(>op(c1,c2),>op(c1,c3))]], \] and thus,
in the rule above I simply state the cost is some $[[c]]$.  Therefore,
the additional structure imposed on the binary operations for
branching nodes are required to insure the attack tree axioms
from Table~\ref{table:attack-tree-eqs} hold.

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: main.tex
%%% End: 
