\newcommand{\forth}{\frac{1}{4}}
\newcommand{\half}{\frac{1}{2}}

Kordy et al.~\cite{Kordy:2012} gave a very elegant and simple
semantics of attack-defense trees in boolean algebras.  Unfortunately,
while their semantics is elegant it does not capture the resource
aspect of attack trees, it allows contraction, and it does not provide
a means to model sequential conjunction.  In this section we give a
semantics of attack trees in the spirit of Kordy et al.'s using a four
valued logic.

The propositional variables of our ternary logic, denoted by $A$, $B$,
$C$, and $D$, range over the set $\mathsf{4} = \{0, \forth, \half,
1\}$.  We think of $0$ and $1$ as we usually do in boolean algebras,
but we think of $\forth$ and $\half$ as intermediate values that can
be used to break various structural rules.  In particular we will use
these values to prevent exchange for sequential conjunction from
holding, and contraction from holding for parallel and sequential
conjunction.
\begin{definition}
  \label{def:logical-connectives}
  The logical connectives of our four valued logic are defined as
  follows:
  \begin{itemize}
  \item[] Parallel and Sequential Conjunction:
    \begin{center}
      \begin{math}
        \setlength{\arraycolsep}{10px}
        \begin{array}{lll}
          \begin{array}{lll}
            A \odot_4 B = 1,\\
            \,\,\,\,\,\,\,\text{where neither $A$ nor $B$ are $0$}\\
          A \odot_4 B = 0, \text{otherwise}\\
          \\
        \end{array}
        &
        \begin{array}{lll}          
          A \rhd_4 B = 1,\\
          \,\,\,\,\,\,\,\text{where } A \in \{\half, 1\} \text{ and } B \neq 0\\
          \forth \rhd_4 B = \forth, \text{where $B \neq 0$}\\[2px]         
          A \rhd_4 B = 0, \text{otherwise}
        \end{array}
        \end{array}
      \end{math}
    \end{center}
  \item[] Choice: $A \sqcup_4 B = \mathsf{max}(A,B)$    
  \end{itemize}
\end{definition}
These definitions are carefully crafted to satisfy the necessary
properties to model attack trees.  Comparing these definitions with
Kordy et al.'s~\cite{Kordy:2012} work we can see that choice is
defined similarly, but parallel conjunction is not a product --
ordinary conjunction -- but rather a linear tensor product, and
sequential conjunction is not actually definable in a boolean algebra,
and hence, makes heavy use of the intermediate values to insure that
neither exchange nor contraction hold.  

We use the usual notion of equivalence between propositions, that is,
propositions $\phi$ and $\psi$ are considered equivalent, denoted by
$\phi \equiv \psi$, if and only if they have the same truth tables. In
order to model attack trees the previously defined logical connectives
must satisfy the appropriate equivalences corresponding to the
equations between attack trees.  These equivalences are all proven by
the following result.
\begin{lemma}[Properties of the Attack Tree Operators in the Quaternary Semantics]
  \label{lemma:props_atree_ops_quaternary-semantics}
  \begin{itemize}
  \item[] (Symmetry) For any $A$ and $B$, $A \bullet B \equiv B \bullet A$, for $\bullet \in \{\odot_4, \sqcup_4\}$.\\[-5px]
  \item[] (Symmetry for Sequential Conjunction) It is not the case that, for any $A$ and $B$, $A \rhd_4 B \equiv B \rhd_4 A$.\\[-5px]
  \item[] (Associativity) For any $A$, $B$, and $C$, $(A \bullet B) \bullet C \equiv A \bullet (B \bullet C)$, for $\bullet \in \{\odot_4, \rhd_4, \sqcup_4\}$.\\[-5px]
  \item[] (Contraction for Parallel and Sequential Conjunction) It is not the case that for any $A$, $A \bullet A \equiv A$, for $\bullet \in \{\odot_4, \rhd_4\}$.\\[-5px]
  \item[] (Contraction for Choice) For any $A$, $A \sqcup_4 A \equiv_4 A$\\[-5px]
  \item[] (Left Distributive Law) For any $A$, $B$, and $C$, $A \bullet (B \sqcup_4 C) \equiv (A \bullet B) \sqcup_4 (A \bullet C)$, for $\bullet \in \{\odot_4, \rhd_4\}$.\\[-5px]
  \item[] (Right Distributive Law) For any $A$, $B$, and $C$, $(A \sqcup_4 B) \bullet C \equiv (A \bullet C) \sqcup_4 (B \bullet C)$, for $\bullet \in \{\odot_4, \rhd_4\}$.\\
  \end{itemize}
\end{lemma}
\begin{proof}
  Symmetry, associativity, contraction for choice, and the
  distributive laws for each operator hold by simply comparing truth
  tables.  As for contraction for parallel conjunction, suppose $A =
  \forth$.  Then by definition $A \odot_4 A = 1$, but $\forth$ is not
  $1$.  Contraction for sequential conjunction also fails, suppose $A
  = \half$.  Then by definition $A \rhd_4 A = 1$, but $\half$ is not
  $1$.  Similarly, symmetry fails for sequential conjunction. Suppose
  $A = \forth$ and $B = \half$.  Then $A \rhd_4 B = \forth$, but $B
  \rhd_4 A = 1$.
\end{proof}

At this point it is quite easy to model attack trees as formulas.  The
following defines their interpretation.
\begin{definition}
  \label{def:interp-aterms-ternary}
  Suppose $\mathbb{B}$ is some set of base attacks, and $\nu :
  \mathbb{B} \mto \mathsf{PVar}$ is an assignment of base attacks to
  propositional variables.  Then we define the interpretation of
  $\mathsf{ATerms}$ to propositions as follows:
  \begin{center}
    \begin{math}
      \setlength{\arraycolsep}{5px}
      \begin{array}{lll}
        \begin{array}{lll}
          \interp{[[b]] \in \mathbb{B}} & = & \nu([[b]])\\
          \interp{[[AND T1 T2]]} & = & \interp{[[T1]]} \odot_4 \interp{[[T2]]}\\
        \end{array}
        &
        \begin{array}{lll}
          \interp{[[SAND T1 T2]]} & = & \interp{[[T1]]} \rhd_4 \interp{[[T2]]}\\
          \interp{[[OR T1 T2]]} & = & \interp{[[T1]]} \sqcup_4 \interp{[[T2]]}\\
        \end{array}
      \end{array}
    \end{math}
  \end{center}
\end{definition}
We can use this semantics to prove equivalences between attack trees.
\begin{lemma}[Equivalence of Attack Trees in the Ternary Semantics]
  \label{lemma:equivalence_of_attack_trees}
  Suppose $\mathbb{B}$ is some set of base attacks, and $\nu :
  \mathbb{B} \mto \mathsf{PVar}$ is an assignment of base attacks to
  propositional variables.  Then for any attack trees $[[T1]]$ and
  $[[T2]]$, $[[T1 ~ T2]]$ if and only if $\interp{[[T1]]} \equiv \interp{[[T2]]}$.
\end{lemma}
\begin{proof}
  This proof holds by induction on the form of $[[T1 ~ T2]]$.
\end{proof}
This is a very simple and elegant semantics, but it also leads to a
more substantial theory.

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: main.tex
%%% End: 
