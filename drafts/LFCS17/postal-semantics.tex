Classical natural deduction has a semantics in boolean algebras, and
so the semantics in the previous section begs the question of whether
there is a natural deduction system that can be used to reason about
attack trees.  We answer this question in the positive, but before
defining the logic we first build up a non-trivial concrete
categorical model of our desired logic in dialectica spaces, but this
first requires the abstraction of the quaternary semantics into a
preorder semantics we call the lineale semantics of SAND attack trees.
This semantics will live at the base of the dialectica space model
given in the next section, but it also begins to shed light on new and
interesting reasoning tools for attack trees.

We denote by $\leq_4 : \Four \times \Four \to \Four$ the obvious
preorder on $\Four$ making $(\Four, \leq_4)$ a preordered set
(proset).  It is well known that every preordered set induces a
category whose objects are the elements of the carrier set, here
$\Four$, and morphisms $\Hom{\Four}{a}{b} = a \leq_4 b$.  Composition
of morphisms hold by transitivity and identities exists by
reflexivity.  Under this setting it is straightforward to show that
for any propositions $\phi$ and $\psi$ over $\Four$ we have $\phi
\equiv \psi$ if and only if $\phi \leq_4 \psi$ and $\psi \leq_4 \phi$.
Thus, every result proven for the logical connectives on $\Four$ in
the previous section induce properties on morphisms in this setting.

In addition to the induced properties just mentioned we also have the
following new ones which are required when lifting this semantics to
dialectica spaces, but are also important when building a
corresponding logic.
\begin{lemma}[Functorality]
  \label{lemma:functorality}
  For any $A$, $B$, $C$, and $D$, if $A \leq_4 C$ and $B \le_4 D$,
  then $(A \bullet B) \leq_4 (C \bullet D)$, for $\bullet \in \{\odot_4,
  \rhd_4, \sqcup_4 \}$.
\end{lemma}
\begin{proof}
  Each part holds by case analysis over $A$, $B$, $C$,
  and $D$.  In any cases where $(A \bullet B) \leq_4 (C \bullet D)$
  does not hold, then one of the premises will also not hold.
\end{proof}
The logic we are building up is indeed intuitionistic, but none of the
operators we have introduced thus far are closed, but we can define
the standard symmetric linear tensor product in $\Four$ that is
closed.
\begin{definition}
  \label{def:tensor-and-implication}
  The following defines the linear tensor product on $\Four$ as well
  as linear implication:  
    \begin{center}
      \begin{math}
        \setlength{\arraycolsep}{10px}
        \begin{array}{lll}
          \begin{array}{lll}
            A \otimes_4 B = \mathsf{max}(A,B), \\
          \,\,\,\,\,\,\,\,\,\,\,\,\text{where $A$ nor $B$ are $0$}\\
          A \otimes_4 B = 0, \text{otherwise}
          \end{array}
          &
          \begin{array}{lll}
          A \limp_4 B = 0, \text{where $B <_4 A$}\\
          A \limp_4 A = A, \text{where $A \in \{\forth,\half\}$}\\
          A \limp_4 B = 1, \text{otherwise}
        \end{array}
        \end{array}
      \end{math}
    \end{center}
    The unit of the tensor product is $I_4 = \forth$.\\   
\end{definition}
The expected monoidal properties hold for the tensor product.
\begin{lemma}[Tensor is Symmetric Monoidal Closed]
  \label{lemma:tensor_is_symmetric_monoidal_closed}
  \begin{itemize}
  \item[] (Symmetry) For any $A$ and $B$, $A \otimes_4 B \equiv B \otimes A$.\\[-5px]
  \item[] (Associativity) For any $A$, $B$, and $C$, $(A \otimes_4 B) \otimes_4 C \equiv A \otimes_4 (B \otimes_4 C)$.\\[-5px]
  \item[] (Unitors) For any $A$, $(A \otimes I_4) \equiv A \equiv (I_4 \otimes A)$.\\[-5px]
  \item[] (Tensor is Functorial) For any $A$, $B$, $C$, and $D$, if $A \leq_4 C$ and $B \le_4 D$, then
    $(A \otimes_4 B) \leq_4 (C \otimes_4 D)$.\\[-5px]
  \item[] (Implication is Functorial) For any $A$, $B$, $C$, and $D$, if
    $C \leq_4 A$ and $B \leq_4 D$, then $(A \limp_4 B) \leq_4 (C
    \limp_4 D)$.\\[-5px]
  \item[] (Closure) For any $A$, $B$, and $C$, $(A \otimes_4 B) \leq_4 C$ if and only if $A \leq_4 (B \limp_4 C)$.
  \end{itemize}
\end{lemma}
\begin{proof}
  The top three cases hold by simply comparing truth tables. Finally,
  the last three cases hold by a case analysis over $A$, $B$, $C$, and
  $D$.  If at any time the conclusion is false, then one of the
  premises will also be false.
\end{proof}

We now define lineales which depend on the notion of a monoidal
proset.  The definition of lineales given here is a slight
generalization over the original definition given by Hyland and de
Paiva -- see Definition 1 of \cite{Hyland:1991}.  They base lineales
on posets instead of prosets, but the formalization given here shows
that anti-symmetry can be safely dropped.
\begin{definition}
  \label{def:monoidal-proset}
  A \textbf{monoidal proset} is a proset, $(L, \leq)$, with a given
  symmetric monoidal structure $(L, \circ, e)$.  That is, a set $L$
  with a given binary relation $\leq : L \times L \to L$ satisfying
  the following:
  \begin{itemize}
  \item (reflexivity) $a \leq a$ for any $a \in L$
  \item (transitivity) If $a \leq b$ and $b \leq c$, then $a \leq c$
  \end{itemize}
  together with a monoidal structure $(\circ, e)$ consisting of a
  binary operation, called multiplication, $\circ : L \times L \to L$
  and a distinguished element $e \in L$ called the unit such that the
  following hold:
  \begin{itemize}
  \item (associativity) $(a \circ b) \circ c = a \circ (b \circ c)$
  \item (identity) $a \circ e = a = e \circ a$
  \item (symmetry) $a \circ b = b \circ a$
  \end{itemize}
  Finally, the structures must be compatible, that is, if $a \leq b$,
  then $a \circ c \leq b \circ c$ for any $c \in L$.
\end{definition}
Now a lineale can be seen as essentially a symmetric monoidal closed
category in the category prosets.
\begin{definition}
  \label{def:lineale}
  A \textbf{lineale} is a monoidal proset, $(L, \leq, \circ, e)$, with
  a given binary operation, called implication, $\limp : L \times L
  \to L$ such that the following hold:
  \begin{itemize}
  \item (relative complement) $(a \limp b) \circ a \leq b$ 
  \item (adjunction) If $a \circ y \leq b$, then $y \leq a \limp b$
  \end{itemize}
\end{definition}
The set $\mathsf{2} = \{0,1\}$ is an example of a lineale where the
order is the usual one, the multiplication is boolean conjunction, and
the implication is boolean implication.  This example is not that
interesting, because $\mathsf{2}$ is a boolean algebra.  An example of
a proper lineale can be given using the three element set
$\mathsf{3} = \{0,\half, 1\}$, but one must be careful when
defining lineales, because it is possible to instead define Heyting
algebras, and hence, become nonlinear.

Given the operations and properties shown for $(\Four, \leq_4)$ above
we can easily prove that $(\Four, \leq_4)$ defines a lineale.
\begin{lemma}
  \label{lemma:four_is_a_lineale}
  The proset, $(\Four, \leq_4, \otimes_4, I_4, \limp_4)$ is a lineale.
\end{lemma}
\begin{proof}
  First, $(\Four, \leq_4, \otimes_4, I_4)$ defines a monoidal proset,
  because the tensor product is associative, $I_4$ is the identity,
  and symmetric by
  Lemma~\ref{lemma:tensor_is_symmetric_monoidal_closed}.  We can also
  show that the tensor product is compatible, that is, if $A \leq_4
  B$, then $(A \otimes_4 C) \leq_4 (B \otimes C)$ for any $C$.
  Suppose $A \leq_4 B$, then by reflexivity we also know that $C
  \leq_4 C$.  Thus, by functorality,
  Lemma~\ref{lemma:tensor_is_symmetric_monoidal_closed}, we obtain our
  result.

  Finally, we show that $(\Four, \leq_4, \otimes_4, I_4, \limp_4)$ is
  a lineale.  The adjunction property already holds by
  Lemma~\ref{lemma:tensor_is_symmetric_monoidal_closed}, thus, all
  that is left to show is that the relative complement holds. We know
  by Lemma~\ref{lemma:tensor_is_symmetric_monoidal_closed} that for
  any $A$, $B$, and $C$, if $A \leq_4 (B \limp_4 C)$, then $(A
  \otimes_4 B) \leq_4 C$.  In addition, we know by reflexivity that
  $(A \limp_4 B) \leq_4 (A \limp_4 B)$, thus by the previous property we obtain
  that $((A \limp_4 B) \otimes_4 A) \leq_4 B$.
\end{proof}

The interpretation of attack trees into the lineale $(\Four, \leq_4,
\otimes_4, I_4, \limp_4)$ does not change from
Definition~\ref{def:interp-aterms-ternary}, but the equivalences
between attack trees, Lemma~\ref{lemma:equivalence_of_attack_trees},
can be abstracted.
\begin{lemma}[Equivalence of Attack Trees in the Lineale Semantics]
  \label{lemma:equivalence_of_attack_trees_lineale}
  Suppose $\mathbb{B}$ is some set of base attacks, and $\alpha :
  \mathbb{B} \mto \mathsf{PVar}$ is an assignment of base attacks to
  propositional variables.  Then for any attack trees $[[T1]]$ and
  $[[T2]]$, $[[T1 ~ T2]]$ if and only if $\interp{[[T1]]} \leq_4 \interp{[[T2]]}$ and
  $\interp{[[T2]]} \leq_4 \interp{[[T1]]}$.
\end{lemma}
\begin{proof}
  This proof holds by induction on the form of $[[T1 ~ T2]]$.
\end{proof}
This result seems basic, but has some interesting consequences.
Notice that we can break up equivalence of attack trees, $[[T1 ~
    T2]]$, into rewrite rules $[[T1 ~> T2]]$ and $[[T1 <~ T2]]$ by
reading each equivalence from left-to-right and right-to-left
respectively, such that, $[[T1 ~ T2]]$ if and only if $[[T1 ~>* T2]]$
and $[[T1 *<~ T2]]$.  Then we have the following corollary.
\begin{corollary}[Simplifications of Attack Trees in the Lineale Semantics]
  \label{corollary:attack_trees_rewrites_mor_lineale}
  Suppose $\mathbb{B}$ is some set of base attacks, and $\alpha :
  \mathbb{B} \mto \mathsf{PVar}$ is an assignment of base attacks to
  propositional variables.  Then for any attack trees $[[T1]]$ and
  $[[T2]]$ the following hold:
  \begin{enumerate}[label=\roman*.]
  \item if $[[T1 ~> T2]]$, then $\interp{[[T1]]} \leq_4 \interp{[[T2]]}$
  \item if $[[T1 <~ T2]]$, then $\interp{[[T2]]} \leq_4 \interp{[[T1]]}$
  \end{enumerate}
\end{corollary}
More generally, the previous two results show that equivalence of
attack trees can actually be modeled by isomorphisms in a category,
and that if we break the equivalences up into rewrite rules, then
rewriting attack trees corresponds to exhibiting a morphism in a
category.

The previous corollary also has practical consequences. The
left-to-right rewrite rules, what we call the attack tree
simplification rules, can be used to normalize attack trees, we
discuss this in more detail in Section~\ref{?}, such that, if two
attack trees have the same normal form, then they are equivalent.  The
previous corollary implies that doing so is semantically valid.

Finally, the previous two results lead us to a more logical viewpoint.
If we know $\interp{[[T1]]} \leq_4 \interp{[[T2]]}$, then by closure
$I_4 \leq_4 (\interp{[[T1]]} \limp_4 \interp{[[T2]]})$.  Thus, two
attack trees are then equivalent if and only if they are
bi-conditionally related, i.e. $I_4 \leq_4 (\interp{[[T1]]} \limp_4
\interp{[[T2]]})$ and $I_4 \leq_4 (\interp{[[T2]]} \limp_4
\interp{[[T1]]})$.  Therefore, if we are able to find a logic that is
sound with respect to the semantics laid out thus far, then we can use
it to reason about attack trees using linear implication, but can we
first define a non-trivial -- not in prosets -- categorical model of
attack trees?
